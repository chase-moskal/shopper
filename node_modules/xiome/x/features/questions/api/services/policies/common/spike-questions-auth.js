import * as dbmage from "dbmage";
import { UnconstrainedTable } from "../../../../../../framework/api/unconstrained-table.js";
export async function spikeQuestionsAuth(meta, headers, questionsDatabase, basePolicy) {
    const auth = await basePolicy(meta, headers);
    const appId = dbmage.Id.fromString(auth.access.appId);
    return {
        ...auth,
        questionsDatabase: UnconstrainedTable
            .constrainDatabaseForApp({ database: questionsDatabase, appId }),
    };
}
//# sourceMappingURL=spike-questions-auth.js.map